<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Boekingssysteem - Admin</title>
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ‚ï¸</text></svg>">
  <link rel="stylesheet" href="style.css">
  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Chart.js for statistics -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- EmailJS for waitlist notifications -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

  <!-- Inline script to set title immediately to prevent flash -->
  <script>
    // Hide the body until we load the correct title (when DOM is ready)
    document.addEventListener('DOMContentLoaded', function() {
      if (document.body) {
        document.body.style.visibility = 'hidden';
      }
    });

    // Initialize Supabase client when library is loaded
    function initSupabase() {
      if (typeof supabase !== 'undefined' && supabase.createClient) {
        window.supabase = supabase.createClient(
          "https://owrojqutbtoifitqijdi.supabase.co",
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93cm9qcXV0YnRvaWZpdHFpamRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMjQ3NjUsImV4cCI6MjA3MzcwMDc2NX0.ugj1qCdzDd_40ZqJE5pYuMarFOhLlT3ZU_8piIPt_Mc"
        );
        loadSiteTitle();
      } else {
        // Retry after a short delay
        setTimeout(initSupabase, 50);
      }
    }

    // Initialize EmailJS when library is loaded
    function initEmailJS() {
      if (typeof emailjs !== 'undefined' && emailjs.init) {
        // Initialize EmailJS with your public key
        emailjs.init('A3JIgDeJroSYPlB69'); // Replace with your actual EmailJS public key
        console.log('EmailJS initialized successfully');
      } else {
        // Retry after a short delay
        setTimeout(initEmailJS, 50);
      }
    }

    // Load and apply site title immediately
    function loadSiteTitle() {
      (async function() {
        try {
        const { data, error } = await window.supabase
          .from('settings')
          .select('value')
          .eq('key', 'site_title')
          .single();

        if (data && data.value) {
          // Update page title
          document.title = data.value + ' - Admin';
          // Update site title in header
          const siteTitleElement = document.querySelector('h1 a');
          if (siteTitleElement) {
            siteTitleElement.textContent = data.value;
          }
        }
      } catch (error) {
        console.log('Could not load site title, using default');
      } finally {
        // Show the body when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
          if (document.body) {
            document.body.style.visibility = 'visible';
          }
        });
        
        // Initialize EmailJS
        initEmailJS();

        // Also try to show immediately if body already exists
        if (document.body) {
          document.body.style.visibility = 'visible';
        }
      }
    })();

    // Start the initialization
    initSupabase();
  </script>
</head>
<body>
  <div class="container">
    <header>
      <h1><a href="index.html" style="text-decoration: none; color: inherit;">Boekingssysteem</a> - Admin</h1>
    <button id="logoutBtn" class="btn btn-outline">Logout</button>
    </header>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button class="tab-btn active" data-tab="agenda">ğŸ“… Agenda</button>
      <button class="tab-btn" data-tab="boekingen">ğŸ“‹ Afspraken</button>
      <button class="tab-btn" data-tab="diensten">âœ‚ï¸ Diensten</button>
      <button class="tab-btn" data-tab="kappers">ğŸ‘¨â€ğŸ’¼ Kappers</button>
      <button class="tab-btn" data-tab="klanten">ğŸ‘¥ Klanten</button>
      <button class="tab-btn" data-tab="statistieken">ğŸ“Š Statistieken</button>
      <button class="tab-btn" data-tab="instellingen">âš™ï¸ Instellingen</button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Agenda Tab -->
      <div id="agenda" class="tab-panel active">
        <div class="widget">
          <h2>Agenda Beheer</h2>

          <!-- Week Navigation -->
          <div class="week-navigation">
            <button id="prevWeekBtn" class="btn btn-outline">â† Vorige Week</button>
            <h3 id="currentWeekDisplay">Week van 15 sep - 21 sep 2025</h3>
            <button id="nextWeekBtn" class="btn btn-outline">Volgende Week â†’</button>
          </div>


          <!-- Modern Week Calendar -->
          <div class="modern-calendar">
            <!-- Calendar Header -->
            <div class="calendar-header">
              <div class="week-info">
                <span class="week-number" id="weekNumber">W 38</span>
                <span class="week-dates" id="weekDates">15-21 Sep 2025</span>
              </div>
            </div>

            <!-- Days Header -->
            <div class="days-header">
              <div class="time-header">Tijd</div>
              <div class="day-header" data-day="monday">
                <div class="day-name">Maandag</div>
                <div class="day-date" id="mondayDate">15 Sep</div>
              </div>
              <div class="day-header" data-day="tuesday">
                <div class="day-name">Dinsdag</div>
                <div class="day-date" id="tuesdayDate">16 Sep</div>
              </div>
              <div class="day-header" data-day="wednesday">
                <div class="day-name">Woensdag</div>
                <div class="day-date" id="wednesdayDate">17 Sep</div>
              </div>
              <div class="day-header" data-day="thursday">
                <div class="day-name">Donderdag</div>
                <div class="day-date" id="thursdayDate">18 Sep</div>
              </div>
              <div class="day-header" data-day="friday">
                <div class="day-name">Vrijdag</div>
                <div class="day-date" id="fridayDate">19 Sep</div>
              </div>
              <div class="day-header" data-day="saturday">
                <div class="day-name">Zaterdag</div>
                <div class="day-date" id="saturdayDate">20 Sep</div>
              </div>
              <div class="day-header" data-day="sunday">
                <div class="day-name">Zondag</div>
                <div class="day-date" id="sundayDate">21 Sep</div>
              </div>
            </div>

            <!-- Calendar Body -->
            <div class="calendar-body">
              <div class="time-column">
                <div class="time-labels" id="timeLabels"></div>
              </div>
              <div class="days-container">
                <div class="day-column" data-day="monday">
                  <div class="day-appointments" id="appointmentsMonday"></div>
                </div>
                <div class="day-column" data-day="tuesday">
                  <div class="day-appointments" id="appointmentsTuesday"></div>
                </div>
                <div class="day-column" data-day="wednesday">
                  <div class="day-appointments" id="appointmentsWednesday"></div>
                </div>
                <div class="day-column" data-day="thursday">
                  <div class="day-appointments" id="appointmentsThursday"></div>
                </div>
                <div class="day-column" data-day="friday">
                  <div class="day-appointments" id="appointmentsFriday"></div>
                </div>
                <div class="day-column" data-day="saturday">
                  <div class="day-appointments" id="appointmentsSaturday"></div>
                </div>
                <div class="day-column" data-day="sunday">
                  <div class="day-appointments" id="appointmentsSunday"></div>
                </div>
              </div>

              <!-- Current Time Line -->
              <div class="current-time-line" id="currentTimeLine"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Appointment Details Popup -->
      <div id="appointmentDetailsPopup" class="popup-overlay" style="display: none;">
        <div class="popup-content">
          <div class="popup-header">
            <h3>Afspraak Details</h3>
            <button id="closeAppointmentPopup" class="btn btn-sm">&times;</button>
          </div>
          <div class="popup-body">
            <div class="appointment-details">
              <div class="detail-section">
                <h4>Klant Informatie</h4>
                <div class="detail-item">
                  <span class="label">Naam:</span>
                  <span class="value" id="appointmentCustomerName">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Email:</span>
                  <span class="value" id="appointmentCustomerEmail">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Telefoon:</span>
                  <span class="value" id="appointmentCustomerPhone">-</span>
                </div>
              </div>

              <div class="detail-section">
                <h4>Afspraak Informatie</h4>
                <div class="detail-item">
                  <span class="label">Datum:</span>
                  <span class="value" id="appointmentDate">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Tijd:</span>
                  <span class="value" id="appointmentTime">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Kapper:</span>
                  <span class="value" id="appointmentKapper">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Dienst:</span>
                  <span class="value" id="appointmentService">-</span>
                </div>
                <div class="detail-item">
                  <span class="label">Prijs:</span>
                  <span class="value" id="appointmentPrice">-</span>
                </div>
              </div>
            </div>
          </div>
          <div class="popup-footer">
            <button id="editAppointmentBtn" class="btn btn-primary">Wijzigen</button>
            <span id="deleteAppointmentBtn" class="delete-emoji">ğŸ—‘ï¸</span>
            <button id="closeAppointmentDetailsBtn" class="btn btn-secondary">Sluiten</button>
          </div>

          <!-- Edit Form (hidden by default) -->
          <div id="editAppointmentForm" class="edit-form" style="display: none;">
            <h3>Afspraak Wijzigen</h3>
            <div class="form-group">
              <label for="editCustomerName">Klantnaam:</label>
              <input type="text" id="editCustomerName" class="form-input">
            </div>
            <div class="form-group">
              <label for="editCustomerEmail">Email:</label>
              <input type="email" id="editCustomerEmail" class="form-input">
            </div>
            <div class="form-group">
              <label for="editCustomerPhone">Telefoon:</label>
              <input type="tel" id="editCustomerPhone" class="form-input">
            </div>
            <div class="form-group">
              <label for="editAppointmentDate">Datum:</label>
              <input type="date" id="editAppointmentDate" class="form-input">
            </div>
            <div class="form-group">
              <label for="editAppointmentTime">Tijd:</label>
              <select id="editAppointmentTime" class="form-input">
                <!-- Will be populated with quarter-hour slots -->
              </select>
            </div>
            <div class="form-group">
              <label for="editAppointmentKapper">Kapper:</label>
              <select id="editAppointmentKapper" class="form-input">
                <option value="">Kies een kapper...</option>
              </select>
            </div>
            <div class="form-group">
              <label for="editAppointmentService">Dienst:</label>
              <select id="editAppointmentService" class="form-input">
                <option value="">Kies een dienst...</option>
              </select>
            </div>
            <div class="edit-form-actions">
              <button id="saveAppointmentBtn" class="btn btn-primary save-btn">Opslaan</button>
              <button id="cancelEditBtn" class="btn btn-secondary">Annuleren</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Boekingen Tab -->
      <div id="boekingen" class="tab-panel">
        <div class="widget">
          <h2>Afspraken Overzicht</h2>

          <!-- Filters -->
          <div class="bookings-filters">
            <div class="filter-group">
              <label for="dateRangeFilter">Periode:</label>
              <select id="dateRangeFilter">
                <option value="all">Alle afspraken</option>
                <option value="today">Vandaag</option>
                <option value="week">Deze week</option>
                <option value="month">Deze maand</option>
                <option value="custom">Aangepast</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="sortOrderFilter">Sorteren:</label>
              <select id="sortOrderFilter">
                <option value="newest">Nieuwste eerst</option>
                <option value="oldest">Oudste eerst</option>
                <option value="date-asc">Datum oplopend</option>
                <option value="date-desc">Datum aflopend</option>
              </select>
            </div>

            <div class="filter-group">
              <label for="kapperFilter">Kapper:</label>
              <select id="kapperFilter">
                <option value="all">Alle kappers</option>
              </select>
            </div>

            <button id="refreshBookingsBtn" class="btn btn-primary">ğŸ”„ Ververs</button>
            <div id="autoUpdateIndicator" class="auto-update-indicator" style="display: none;">
              <span class="update-dot"></span>
              <span>Auto-update actief</span>
            </div>
          </div>

          <!-- Bookings List -->
          <div class="bookings-list-container">
            <div class="bookings-list-header">
              <div class="header-cell">Datum & Tijd</div>
              <div class="header-cell">Klant</div>
              <div class="header-cell">Kapper</div>
              <div class="header-cell">Dienst</div>
              <div class="header-cell">Prijs</div>
              <div class="header-cell">Status</div>
              <div class="header-cell">Acties</div>
            </div>
            <div id="bookingsList" class="bookings-list">
              <!-- Bookings will be populated here -->
            </div>
          </div>

          <!-- Pagination -->
          <div class="bookings-pagination">
            <button id="prevPageBtn" class="btn btn-outline" disabled>â† Vorige</button>
            <span id="pageInfo">Pagina 1 van 1</span>
            <button id="nextPageBtn" class="btn btn-outline" disabled>Volgende â†’</button>
          </div>
        </div>
      </div>

      <!-- Diensten Tab -->
      <div id="diensten" class="tab-panel">
        <div class="widget">
          <h2>âœ‚ï¸ Diensten Beheer</h2>

          <!-- Add Service Section -->
          <div class="add-service-section">
            <h3>Nieuwe Dienst Toevoegen</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="newDienstName">Dienst Naam</label>
                <input type="text" id="newDienstName" placeholder="Bijv. Knippen & Wassen">
              </div>
              <div class="form-group">
                <label for="newDienstPrice">Prijs (â‚¬)</label>
                <input type="number" id="newDienstPrice" placeholder="25.00" min="0" step="0.01">
              </div>
              <div class="form-group">
                <label for="newDienstDuration">Duur (minuten)</label>
                <input type="number" id="newDienstDuration" placeholder="30" min="5" max="300" value="30">
              </div>
              <div class="form-group">
                <label>&nbsp;</label>
                <button id="addDienstBtn" class="btn btn-primary">Dienst Toevoegen</button>
              </div>
            </div>
          </div>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Naam</th>
                <th>Prijs</th>
                <th>Duur</th>
          <th>Actie</th>
        </tr>
      </thead>
      <tbody id="dienstenBody"></tbody>
    </table>
        </div>
      </div>

      <!-- Kappers Tab -->
      <div id="kappers" class="tab-panel">
        <div class="widget">
          <h2>ğŸ’‡â€â™‚ï¸ Kappers Beheer</h2>

          <!-- Kapper Sub-tabs -->
          <div class="sub-tab-navigation">
            <button class="sub-tab-btn active" data-subtab="manage">Kappers Beheren</button>
            <button class="sub-tab-btn" data-subtab="availability">Beschikbaarheid Instellen</button>
          </div>

          <!-- Manage Kappers Sub-tab -->
          <div id="manage-kappers" class="sub-tab-panel active">
            <!-- Add Kapper Section -->
            <div class="add-kapper-section">
              <h3>Nieuwe Kapper Toevoegen</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="newKapperName">Kapper Naam</label>
                  <input type="text" id="newKapperName" placeholder="Bijv. Sven">
                </div>
                <div class="form-group">
                  <label>&nbsp;</label>
                  <button id="addKapperBtn" class="btn btn-primary">Kapper Toevoegen</button>
                </div>
              </div>
            </div>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Naam</th>
          <th>Actie</th>
        </tr>
      </thead>
      <tbody id="kappersBody"></tbody>
    </table>
          </div>

          <!-- Kapper Availability Sub-tab -->
          <div id="availability-kappers" class="sub-tab-panel">
            <div class="kapper-selector">
              <label>Selecteer Kapper:</label>
              <div id="kapperAvailabilityCards" class="kapper-cards">
                <!-- Kapper cards will be populated by JavaScript -->
              </div>
            </div>

            <div id="kapperAvailabilityContent" style="display: none;">
              <h3>Beschikbaarheid Instellen</h3>

              <!-- Days of the week -->
              <div class="availability-days">
                <h4>Beschikbare Dagen</h4>
                <div class="days-grid">
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="monday">
                    <span>Maandag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="tuesday">
                    <span>Dinsdag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="wednesday">
                    <span>Woensdag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="thursday">
                    <span>Donderdag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="friday">
                    <span>Vrijdag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="saturday">
                    <span>Zaterdag</span>
                  </label>
                  <label class="day-checkbox">
                    <input type="checkbox" data-day="sunday">
                    <span>Zondag</span>
                  </label>
                </div>
              </div>

              <!-- Working hours -->
              <div class="availability-hours">
                <h4>Werkuren per Dag</h4>
                <div class="hours-grid">
                  <div class="day-hours" data-day="monday" style="display: none;">
                    <h5>Maandag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="monday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="monday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="tuesday" style="display: none;">
                    <h5>Dinsdag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="tuesday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="tuesday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="wednesday" style="display: none;">
                    <h5>Woensdag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="wednesday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="wednesday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="thursday" style="display: none;">
                    <h5>Donderdag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="thursday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="thursday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="friday" style="display: none;">
                    <h5>Vrijdag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="friday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="friday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="saturday" style="display: none;">
                    <h5>Zaterdag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="saturday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="saturday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                  <div class="day-hours" data-day="sunday" style="display: none;">
                    <h5>Zondag</h5>
                    <div class="time-inputs">
                      <label>
                        Start tijd:
                        <input type="time" data-day="sunday" data-type="start" value="09:00">
                      </label>
                      <label>
                        Eind tijd:
                        <input type="time" data-day="sunday" data-type="end" value="17:00">
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="availability-actions">
                <button id="saveAvailabilityBtn" class="save-btn">Beschikbaarheid Opslaan</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Statistieken Tab -->
      <div id="statistieken" class="tab-panel">
        <div class="widget">
          <h2>ğŸ“Š Bedrijfsstatistieken</h2>

          <!-- Date Range Selector -->
          <div class="stats-controls">
            <div class="date-range-selector">
              <label for="statsDateRange">Periode:</label>
              <select id="statsDateRange">
                <option value="7">Laatste 7 dagen</option>
                <option value="30" selected>Laatste 30 dagen</option>
                <option value="90">Laatste 3 maanden</option>
                <option value="365">Laatste jaar</option>
              </select>
            </div>
            <button id="refreshStats" class="btn btn-primary">ğŸ”„ Vernieuwen</button>
          </div>

          <!-- Statistics Cards -->
          <div class="stats-grid">
            <!-- Revenue Overview -->
            <div class="stats-card revenue-card">
              <div class="stats-header">
                <h3>ğŸ’° Totale Omzet</h3>
                <span class="stats-icon">ğŸ’¸</span>
              </div>
              <div class="stats-value" id="totalRevenue">â‚¬0</div>
              <div class="stats-change" id="revenueChange">+0%</div>
            </div>

            <!-- Total Appointments -->
            <div class="stats-card appointments-card">
              <div class="stats-header">
                <h3>ğŸ“… Totaal Afspraken</h3>
                <span class="stats-icon">ğŸ“‹</span>
              </div>
              <div class="stats-value" id="totalAppointments">0</div>
              <div class="stats-change" id="appointmentsChange">+0%</div>
            </div>

            <!-- Average Revenue per Appointment -->
            <div class="stats-card avg-revenue-card">
              <div class="stats-header">
                <h3>ğŸ“ˆ Gem. Omzet per Afspraak</h3>
                <span class="stats-icon">ğŸ’</span>
              </div>
              <div class="stats-value" id="avgRevenuePerAppointment">â‚¬0</div>
              <div class="stats-change" id="avgRevenueChange">+0%</div>
            </div>

            <!-- Busiest Day -->
            <div class="stats-card busiest-day-card">
              <div class="stats-header">
                <h3>ğŸ”¥ Drukste Dag</h3>
                <span class="stats-icon">âš¡</span>
              </div>
              <div class="stats-value" id="busiestDay">-</div>
              <div class="stats-change" id="busiestDayCount">0 afspraken</div>
            </div>
          </div>

          <!-- Revenue per Kapper -->
          <div class="stats-section">
            <h3>ğŸ’¼ Omzet per Kapper</h3>
            <div class="kapper-revenue-grid" id="kapperRevenueGrid">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>

          <!-- Popular Services -->
          <div class="stats-section">
            <h3>âœ‚ï¸ Populairste Diensten</h3>
            <div class="services-stats-grid" id="servicesStatsGrid">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>

          <!-- Customer Insights -->
          <div class="stats-section">
            <h3>ğŸ‘¥ Klant Insights</h3>
            <div class="customer-insights-grid">
              <div class="insight-card">
                <h4>ğŸ†• Nieuwe Klanten</h4>
                <div class="insight-value" id="newCustomers">0</div>
                <div class="insight-period">Deze periode</div>
              </div>
              <div class="insight-card">
                <h4>ğŸ”„ Terugkerende Klanten</h4>
                <div class="insight-value" id="returningCustomers">0</div>
                <div class="insight-period">Percentage</div>
              </div>
              <div class="insight-card">
                <h4>â­ Gem. Afspraken per Klant</h4>
                <div class="insight-value" id="avgAppointmentsPerCustomer">0</div>
                <div class="insight-period">Deze periode</div>
              </div>
            </div>
          </div>

          <!-- Daily Revenue Chart -->
          <div class="stats-section">
            <h3>ğŸ“Š Omzet per Dag</h3>
            <div class="chart-container">
              <canvas id="dailyRevenueChart" width="800" height="400"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Klanten Tab -->
      <div id="klanten" class="tab-panel">
        <div class="widget">
          <h2>Klant Management</h2>

          <!-- Sub-tab Navigation for Klanten -->
          <div class="sub-tab-navigation" style="margin-bottom: 20px;">
            <button class="sub-tab-btn active" data-subtab="klanten-overzicht">ğŸ‘¥ Overzicht</button>
            <button class="sub-tab-btn" data-subtab="klanten-importeren">ğŸ“¥ Importeren</button>
          </div>

          <!-- Klanten Overzicht Sub-tab -->
          <div id="klanten-overzicht" class="sub-tab-panel active">
            <!-- Search and Filter Section -->
            <div class="search-section">
              <div class="search-bar">
                <input type="text" id="customerSearch" placeholder="Zoek klanten op naam of email...">
                <button id="searchBtn">ğŸ”</button>
              </div>
              <div class="filter-options">
                <select id="statusFilter">
                  <option value="all">Alle klanten</option>
                  <option value="active">Actieve klanten</option>
                  <option value="inactive">Inactieve klanten</option>
                </select>
              </div>
            </div>

            <!-- Customer List -->
            <div class="customer-list" id="customerList">
              <!-- Customers will be loaded here -->
            </div>
          </div>

          <!-- Klanten Importeren Sub-tab -->
          <div id="klanten-importeren" class="sub-tab-panel">
            <div class="import-section">
            <h3>ğŸ“¥ Klanten Importeren</h3>
            <div class="import-container">
              <div class="import-instructions">
                <h4>ğŸ“‹ Hoe te importeren:</h4>
                <ol>
                  <li>Download je klanten data als <strong>CSV bestand</strong></li>
                  <li>Zorg dat de kolommen bevatten: <code>naam, email, telefoon</code></li>
                  <li>Upload het CSV bestand hieronder</li>
                  <li>Controleer de preview en pas mapping aan indien nodig</li>
                  <li>Klik "Importeren" om de klanten toe te voegen</li>
                </ol>

                <div class="csv-example">
                  <h5>ğŸ“„ Voorbeeld CSV format:</h5>
                  <pre>naam,email,telefoon
Jan Janssen,jan@email.com,0612345678
Piet Pietersen,piet@email.com,0687654321</pre>
                </div>
              </div>

              <div class="import-upload">
                <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                <button id="selectCsvFile" class="btn btn-primary">
                  ğŸ“ Selecteer CSV Bestand
                </button>
                <span id="selectedFileName" class="file-name"></span>

                <div class="test-data-section">
                  <hr style="margin: 20px 0; border: 1px solid var(--border-color);">
                  <h5>ğŸ§ª Test Data</h5>
                  <p style="color: var(--text-secondary); font-size: 14px; margin: 10px 0;">
                    Klik hieronder om 25 test klanten met random gegevens aan te maken voor demo doeleinden.
                  </p>
                  <button id="importTestCustomers" class="btn btn-secondary">
                    ğŸ² Genereer 25 Test Klanten
                  </button>
                </div>
              </div>

              <div class="import-preview" id="importPreview" style="display: none;">
                <h4>ğŸ‘€ Preview van geÃ¯mporteerde data:</h4>
                <div class="preview-table-container">
                  <table class="preview-table" id="previewTable">
                    <thead id="previewTableHead"></thead>
                    <tbody id="previewTableBody"></tbody>
    </table>
                </div>

                <div class="import-mapping">
                  <h5>ğŸ—ºï¸ Kolom Mapping:</h5>
                  <div class="mapping-controls" id="mappingControls"></div>
                </div>

                <div class="import-actions">
                  <button id="confirmImport" class="btn btn-success" disabled>
                    âœ… Importeren (<span id="importCount">0</span> klanten)
                  </button>
                  <button id="cancelImport" class="btn btn-secondary">
                    âŒ Annuleren
                  </button>
                </div>
              </div>

              <div class="import-progress" id="importProgress" style="display: none;">
                <h4>â³ Bezig met importeren...</h4>
                <div class="progress-bar">
                  <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">0 van 0 klanten geÃ¯mporteerd</div>
              </div>

              <div class="import-results" id="importResults" style="display: none;">
                <h4>ğŸ“Š Import Resultaten:</h4>
                <div class="results-summary" id="resultsSummary"></div>
                <div class="results-details" id="resultsDetails"></div>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>


      <!-- Instellingen Tab -->
      <div id="instellingen" class="tab-panel">
        <div class="widget">
          <h2>Systeem Instellingen</h2>

          <!-- Settings Tab Navigation -->
          <div class="settings-tab-navigation">
            <button class="settings-tab-btn active" onclick="switchSettingsTab('loyaliteit')">ğŸ† Loyaliteit</button>
            <button class="settings-tab-btn" onclick="switchSettingsTab('thema')">ğŸ¨ Thema</button>
            <button class="settings-tab-btn" onclick="switchSettingsTab('weergave')">ğŸ‘ï¸ Weergave</button>
            <button class="settings-tab-btn" onclick="switchSettingsTab('gebruikers')">ğŸ‘¤ Gebruikers</button>
          </div>

          <!-- Loyaliteit Tab -->
          <div id="settings-loyaliteit" class="settings-tab-panel active">

              <div class="setting-item">
                <div class="setting-info">
                  <label for="loyaltyEnabled">Loyaliteitsprogramma inschakelen</label>
                  <p class="setting-description">Klanten krijgen punten voor afspraken en kunnen korting verdienen</p>
                </div>
                <div class="setting-control">
                  <input type="checkbox" id="loyaltyEnabled" class="toggle-switch">
                </div>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <label for="waitlistEnabled">Wachtlijst functionaliteit inschakelen</label>
                  <p class="setting-description">Klanten kunnen zich aanmelden voor bezette tijden en worden automatisch geboekt</p>
                </div>
                <div class="setting-control">
                  <input type="checkbox" id="waitlistEnabled" class="toggle-switch" checked>
                </div>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <label for="pointsPerAppointment">Punten per afspraak</label>
                  <p class="setting-description">Aantal punten dat klanten krijgen per afspraak</p>
                </div>
                <div class="setting-control">
                  <input type="number" id="pointsPerAppointment" min="1" max="100" value="25">
                  <span class="unit-symbol">punten</span>
                </div>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <label for="pointsForDiscount">Punten voor korting</label>
                  <p class="setting-description">Aantal punten nodig voor een korting</p>
                </div>
                <div class="setting-control">
                  <input type="number" id="pointsForDiscount" min="1" max="1000" value="100">
                  <span class="unit-symbol">punten</span>
                </div>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <label for="discountPercentage">Kortingspercentage</label>
                  <p class="setting-description">Percentage korting bij het bereiken van het puntendoel</p>
                </div>
                <div class="setting-control">
                  <input type="number" id="discountPercentage" min="1" max="100" value="50">
                  <span class="percentage-symbol">%</span>
                </div>
              </div>
          </div>

          <!-- Thema Tab -->
          <div id="settings-thema" class="settings-tab-panel">

            <div class="setting-item">
              <div class="setting-info">
                <label for="primaryColor">Primaire kleur</label>
                <p class="setting-description">Hoofdkleur van de website</p>
              </div>
              <div class="setting-control">
                <input type="color" id="primaryColor" value="#F28B82">
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="secondaryColor">Secundaire kleur</label>
                <p class="setting-description">Aanvullende kleur voor accenten</p>
              </div>
              <div class="setting-control">
                <input type="color" id="secondaryColor" value="#F28B82">
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="backgroundColor">Achtergrond kleur</label>
                <p class="setting-description">Basis achtergrond kleur van de website</p>
              </div>
              <div class="setting-control">
                <input type="color" id="backgroundColor" value="#f8f9fa">
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="textColor">Tekst kleur</label>
                <p class="setting-description">Basis tekst kleur van de website</p>
              </div>
              <div class="setting-control">
                <input type="color" id="textColor" value="#333333">
              </div>
            </div>
          </div>

          <!-- Weergave Tab -->
          <div id="settings-weergave" class="settings-tab-panel">
            <div class="setting-item">
              <div class="setting-info">
                <label for="siteTitle">Website titel</label>
                <p class="setting-description">De naam die bovenaan de website wordt getoond</p>
              </div>
              <div class="setting-control">
                <input type="text" id="siteTitle" value="Boekingssysteem" placeholder="Website titel">
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="timeSlotInterval">Tijdslot interval</label>
                <p class="setting-description">Interval tussen beschikbare tijdsloten (in minuten)</p>
              </div>
              <div class="setting-control">
                <input type="number" id="timeSlotInterval" min="5" max="60" value="15">
                <span class="unit-symbol">min</span>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="maxAdvanceBooking">Maximale vooruitboeking</label>
                <p class="setting-description">Maximum aantal dagen vooruit dat klanten kunnen boeken</p>
              </div>
              <div class="setting-control">
                <input type="number" id="maxAdvanceBooking" min="1" max="365" value="30">
                <span class="unit-symbol">dagen</span>
              </div>
            </div>
          </div>

          <!-- Gebruikers Tab -->
          <div id="settings-gebruikers" class="settings-tab-panel">
            <div class="add-user-section" style="margin-bottom: 30px; padding: 20px; background: var(--surface); border: 1px solid var(--border-color); border-radius: 8px;">
              <h3>â• Nieuwe Gebruiker Toevoegen</h3>
              <div class="add-row">
                <div style="flex:1;">
                  <label for="newUserEmail">E-mailadres</label>
                  <input type="email" id="newUserEmail" placeholder="gebruiker@example.com">
                </div>
                <div style="flex:1;">
                  <label for="newUserPassword">Wachtwoord</label>
                  <input type="password" id="newUserPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                </div>
                <div style="flex:1;">
                  <label for="newUserRole">Rol</label>
                  <select id="newUserRole">
                    <option value="admin">ğŸ”‘ Administrator</option>
                    <option value="manager">ğŸ‘¨â€ğŸ’¼ Manager</option>
                    <option value="staff">ğŸ‘¤ Medewerker</option>
                    <option value="viewer">ğŸ‘ï¸ Bekijker</option>
                  </select>
                </div>
                <div style="align-self: flex-end;">
                  <button id="addUserBtn" class="btn btn-primary">Toevoegen</button>
                </div>
              </div>
            </div>

            <div class="users-list-section">
              <h3>ğŸ“‹ Huidige Gebruikers</h3>
              <div class="search-section" style="margin-bottom: 20px;">
                <div class="search-bar">
                  <input type="text" id="userSearch" placeholder="Zoek gebruikers op email...">
                  <button id="searchUserBtn">ğŸ”</button>
                </div>
                <div class="filter-options">
                  <select id="roleFilter">
                    <option value="all">Alle rollen</option>
                    <option value="admin">Administrator</option>
                    <option value="manager">Manager</option>
                    <option value="staff">Medewerker</option>
                    <option value="viewer">Bekijker</option>
                  </select>
                </div>
              </div>

              <div class="users-list" id="usersList">
                <!-- Users will be loaded here -->
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="settings-actions" style="margin-top: 30px; padding: 20px; background: var(--surface); border: 1px solid var(--border-color); border-radius: 8px;">
            <button id="saveSettings" class="btn btn-primary save-btn">ğŸ’¾ Instellingen Opslaan</button>
            <button id="resetSettings" class="btn btn-secondary">ğŸ”„ Reset naar Standaard</button>
            <button id="previewTheme" class="btn btn-outline">ğŸ‘ï¸ Thema Voorbeeld</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    window.supabase = supabase.createClient(
      "https://owrojqutbtoifitqijdi.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93cm9qcXV0YnRvaWZpdHFpamRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMjQ3NjUsImV4cCI6MjA3MzcwMDc2NX0.ugj1qCdzDd_40ZqJE5pYuMarFOhLlT3ZU_8piIPt_Mc"
    );
  </script>

  <!-- Admin functionaliteiten -->
    <script src="debug-config.js"></script>
    <script src="custom-modals.js"></script>
    <script src="admin.js"></script>
</body>
</html>
<!-- Force deployment -->
